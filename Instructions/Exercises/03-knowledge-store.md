---
lab:
  title: إنشاء مخزن المعلومات مع بحث الذكاء الاصطناعي في Azure
  module: Module 12 - Creating a Knowledge Mining Solution
---

# إنشاء مخزن المعلومات مع بحث الذكاء الاصطناعي في Azure

يستخدم بحث الذكاء الاصطناعي في Azure مساراً إثرائياً لمهارات الذكاء الاصطناعي لاستخراج الحقول التي جرى إنشاؤها بواسطة الذكاء الاصطناعي من المستندات وإدراجها في فهرس البحث. وفي حين يمكن اعتبار أن الفهرس هو المخرجات الأولية من عملية الفهرسة، فإن البيانات التي تم إثراؤها به والتي يحتوي عليها قد تكون مفيدة أيضًا بطرق أخرى. على سبيل المثال:

- لأن الفهرس هو أساسًا مجموعة من عناصر JSON، فكل منها يمثل سجلاً مفهرسًا، فقد يكون من المفيد تصدير العناصر كملفات JSON للتكامل في عملية تزامن البيانات باستخدام أدوات مثل Azure Data Factory.
- قد تحتاج إلى تسوية سجلات الفهرس إلى مخطط ارتباطي من الجداول للتحليل وإعداد التقارير باستخدام أدوات مثل Microsoft Power BI.
- بعد استخراج الصور المضمنة من المستندات في أثناء عملية الفهرسة، قد تحتاج إلى حفظ هذه الصور كملفات.

في هذه الوحدة، ستنفذ مخزن معلومات لـ *Margie's Travel*، وهي وكالة سفر وهمية تستخدم المعلومات في الكتيبات وتقييمات الفنادق لمساعدة العملاء في التخطيط للرحلات.

## الاستعداد لتطوير تطبيق في تعليمة Visual Studio البرمجية

ستطور تطبيق الكلام لديك باستخدام تعليمة Visual Studio البرمجية. تم توفير ملفات التعليمات البرمجية لتطبيقك في GitHub repo.

> **تلميح**: إذا نسخت بالفعل مستودع **mslearn-knowledge-mining**، فافتحه في تعليمة Visual Studio البرمجية. وإلا فاتبع هذه الخطوات لاستنساخه إلى بيئة تطويرك.

1. ابدأ تشغيل Visual Studio Code.
1. افتح لوحة (SHIFT+CTRL+P) وشغّل **Git: استنسخ الأمر ** لاستنساخ مستودع `https://github.com/MicrosoftLearning/mslearn-knowledge-mining` إلى مجلد محلي (لا يُهم أي مجلد).
1. عند استنساخ المستودع، افتح المجلد في تعليمة Visual Studio البرمجية.
1. انتظر حتى تثبيت ملفات إضافية لدعم مشاريع التعليمات البرمجية C# في المستودع.

    > **ملاحظة**: إذا جرت مطالبتك بإضافة الأصول المطلوبة للبناء وتصحيح الأخطاء، فحدد **ليس الآن**.

## إنشاء موارد Azure

> **ملاحظة**: إذا سبق أن أكملت تمرين **[إنشاء حل بحث الذكاء الاصطناعي في Azure](01-azure-search.md)**، ولا يزال لديك موارد بحث الذكاء الاصطناعي في Azure في اشتراكك، يمكنك تخطي هذا المقطع وبدء مقطع **إنشاء حل بحث**. وإلا، اتبع الخطوات أدناه لتوفير موارد Azure المطلوبة.

1. في مستعرض ويب، افتح مدخل Azure في `https://portal.azure.com`، ثم سجل الدخول باستخدام حساب Microsoft المقترن باشتراك Azure لديك.
2. يمكنك الوصول إلى **مجموعات الموارد** في اشتراكك.
3. إذا كنت تستخدم اشتراكاً مقيداً توفرت فيه مجموعة موارد لك، فحدد مجموعة الموارد لعرض خصائصها. وإلا، فعليك إنشاء مجموعة موارد جديدة باسم من اختيارك، وانتقل إليها عند إنشائها.
4. في صفحة **النظرة العامة** لمجموعة الموارد الخاصة بك، لاحظ **معرف الاشتراك** و**الموقع**. ستحتاج إلى هذه القيم، إلى جانب اسم مجموعة الموارد في الخطوات اللاحقة.
5. في تعليمة Visual Studio البرمجية، عليك توسيع المجلد **Labfiles/03-knowledge-store** وحدد **setup.cmd**. ستستخدم دُفعة البرنامج النصي لتشغيل أوامر واجهة سطر أوامر Azure (CLI) المطلوبة لإنشاء موارد Azure التي تحتاجها.
6. انقر بزر الماوس الأيمن فوق المجلد **03-knowledge-store** وحدد **فتح في الوحدة الطرفية المتكاملة**.
7. في جزء terminal، أدخِل الأمر التالي لتأسيس اتصال مصادق إلى اشتراك Azure.

    ```powershell
    az login --output none
    ```

8. عند المطالبة، قم بتسجيل الدخول إلى اشتراكك في Azure. ثم ارجع إلى Visual Studio Code وانتظر حتى تكتمل عملية تسجيل الدخول.
9. يمكنك تشغيل الأمر التالي لسرد مواقع Azure.

    ```powershell
    az account list-locations -o table
    ```

10. في المخرجات، ابحث عن قيمة **الاسم** التي تتوافق مع موقع مجموعة الموارد الخاصة بك (على سبيل المثال، بالنسبة *لشرق الولايات المتحدة*، الاسم المقابل هو *eastus*).
11. في البرنامج النصي **setup.cmd**، عليك تعديل **subscription_id**، و**resource_group**، و**location** المتغيرين باستخدام القيم المناسبة لمعرّف الاشتراك، واسم مجموعة الموارد، واسم الموقع. ثم احفظ التغييرات.
12. في المحطة الطرفية للمجلد **03-knowledge-store**، أدخل الأمر التالي لتشغيل البرنامج النصي:

    ```powershell
    ./setup
    ```
    > **ملاحظة**: الوحدة النمطية Search CLI قيد المعاينة، وقد تتعثر في *- قيد التشغيل ..* العملية. إذا حدث ذلك لأكثر من دقيقتين، فاضغط على CTRL+C لإلغاء العملية طويلة الأمد، ثم حدد **N** عند سؤالك عما إذا كنت تريد إنهاء البرنامج النصي. ومن ثم يجب أن يكتمل بنجاح.
    >
    > إذا فشل البرنامج النصي، فتأكد من حفظه بأسماء المتغيرات الصحيحة وحاول مرة أخرى.

13. عند اكتمال البرنامج النصي، راجع المخرجات التي يعرضها ولاحظ المعلومات التالية حول موارد Azure (ستحتاج هذه القيم لاحقًا):
    - Storage account name
    - سلسلة اتصال التخزين
    - حساب خدمات الذكاء الاصطناعي في Azure
    - مفتاح خدمات الذكاء الاصطناعي في Azure
    - نقطة نهاية خدمة البحث
    - مفتاح مسؤول خدمة البحث
    - مفتاح الاستعلام عن خدمة البحث

14. في مدخل Azure، عليك تحديث مجموعة الموارد وتحقق من أنها تحتوي على حساب مخزن Azure ومورد خدمات الذكاء الاصطناعي في Azure ومورد بحث الذكاء الاصطناعي في Azure.

## إنشاء حل بحث

الآن بعد أن أصبح لديك موارد Azure الضرورية، يمكنك إنشاء حل بحث يتكون من المكونات التالية:

- **مصدر بيانات** يشير إلى المستندات في حاوية تخزين Azure لديك.
- تحدد **مجموعة مهارات** مسار إثراء المهارات لاستخراج الحقول التي جرى إنشاؤها الذكاء الاصطناعي من المستندات. تحدد مجموعة المهارات أيضاً *التوقعات* التي سيجري إنشاؤها في *مخزن المعرفة* الخاص بك.
- **فهرس** يحدد مجموعة قابلة للبحث من سجلات المستندات.
- يستخرج **مفهرس** المستندات من مصدر البيانات، ويطبق مجموعة المهارات، ويملأ الفهرس. كما تستمر عملية الفهرسة في التوقعات المحددة في مجموعة المهارات في مخزن المعرفة.

في هذا التمرين، ستستخدم واجهة بحث الذكاء الاصطناعي في Azure REST لإنشاء هذه المكونات عن طريق إرسال طلبات JSON.

### إعداد JSON لعمليات REST

ستستخدم واجهة REST لإرسال تعريفات JSON لمكونات بحث الذكاء الاصطناعي في Azure لديك.

1. في تعليمة Visual Studio البرمجية في مجلد **03-knowledge-store**، عليك توسيع مجلد **create-search** وحدد **data_source.json**. يحتوي هذا الملف على تعريف JSON لمصدر بيانات يسمى **margies-knowledge-data**.
2. استبدل العنصر النائب **YOUR_CONNECTION_STRING** سلسلة الاتصال لحساب تخزين Azure الخاص بك، والذي يجب أن يشبه ما يلي:

    ```
    DefaultEndpointsProtocol=https;AccountName=ai102str123;AccountKey=12345abcdefg...==;EndpointSuffix=core.windows.net
    ```

    *يمكنك العثور على سلسلة الاتصال في صفحة **مفاتيح الوصول** لحساب التخزين الخاص بك في مدخل Azure.*

3. احفظ ملف JSON المحدث وأغلقه.
4. في مجلد **create-search**، افتح **skillset.json**. يحتوي هذا الملف على تعريف JSON لمصدر بيانات يسمى **margies-knowledge-skillset**.
5. في الجزء العلوي من تعريف مجموعة المهارات، في عنصر **cognitiveServices**، استبدل العنصر النائب **YOUR_COGNITIVE_SERVICES_KEY** بأي من المفاتيح الخاصة بموارد خدمات الذكاء الاصطناعي في Azure الخاصة بك.

    *يمكنك العثور على المفاتيح في صفحة **المفاتيح ونقطة النهاية** لمورد خدمات الذكاء الاصطناعي في Azure في مدخل Microsoft Azure.*

6. في نهاية مجموعة المهارات الموجودة في مجموعة المهارات الخاصة بك، ابحث عن مهارة **Microsoft.Skills.Util.ShaperSkill** المسماة **Define-projection**. تحدد هذه المهارة بنية JSON للبيانات الغنية التي ستُستخدم لتوقعات استمرار التدفق في مخزن المعرفة لكل مستند تجري معالجته بواسطة المفهرس.
7. في الجزء السفلي من ملف مجموعة المهارات، لاحظ أن مجموعة المهارات تتضمن أيضاً تعريف **knowledgeStore**، والذي يتضمن سلسلة اتصال لحساب تخزين Azure حيث سيجري إنشاء مخزن المعرفة، ومجموعة من **الاحتمالات**. هذه المهارات تتضمن ثلاث *مجموعات احتمال*:
    - مجموعة تحتوي على احتمال *عنصر* استناداً إلى مخرج **knowledge_projection** من مهارة المُشكل في مجموعة المهارات.
    - مجموعة تحتوي على احتمال *ملف* استناداً إلى مجموعة **normalized_images** من بيانات الصور المستخرجة من المستندات.
    - مجموعة تحتوي على احتمالات *الجدول* التالي:
        - **KeyPhrases**: تحتوي على عمود مفتاح جرى إنشاؤه تلقائياً و عمود **keyPhrase** معين إلى مجموعة مخرجات **knowledge_projection/key_phrases/** من مهارة المشكّل.
        - **المواقع**: تحتوي على عمود مفتاح جرى إنشاؤه تلقائياً و عمود **الموقع** المعين إلى مجموعة مخرجات **knowledge_projection/key_phrases/** من مهارة المشكّل.
        - **ImageTags**: تحتوي على عمود مفتاح جرى إنشاؤه تلقائياً و عمود **علامة** معين إلى مخرج مجموعة **knowledge_projection/image_tags/** من مهارة المشكّل.
        - **المستندات**: يحتوي على عمود مفتاح جرى إنشاؤه تلقائياً وكافة قيم مخرجات **knowledge_projection** من مهارة المُشكل التي لم يجري تعيينها بالفعل إلى جدول.
8. استبدل العنصر النائب **YOUR_CONNECTION_STRING** لقيمة **storageConnectionString** بسلسلة الاتصال لحساب التخزين الخاص بك.
9. احفظ ملف JSON المحدث وأغلقه.
10. في مجلد **create-search**، افتح **index.json**. يحتوي هذا الملف على تعريف JSON لفهرس يسمى **margies-knowledge-index**.
11. راجع JSON للفهرس، ثم أغلق الملف دون إجراء أي تغييرات.
12. في مجلد **create-search**، افتح **indexer.json**. يحتوي هذا الملف على تعريف JSON لمفهرس يسمى **margies-knowledge-indexer**.
13. راجع JSON للفهرس، ثم أغلق الملف دون إجراء أي تغييرات.

### إرسال طلبات REST

الآن بعد أن أعددت كائنات JSON التي تحدد مكونات حل البحث، يمكنك إرسال مستندات JSON إلى واجهة REST لإنشائها.

1. في مجلد **create-search**، افتح **create-search.cmd**. يستخدم هذا البرنامج النصي الدفعي الأداة المساعدة cURL لإرسال تعريفات JSON إلى واجهة REST لمورد بحث الذكاء الاصطناعي في Azure.
2. استبدل العناصر النائبة والمتغيرة **YOUR_SEARCH_URL** **وYOUR_ADMIN_KEY** بعنوان **Url** وأحد **مفاتيح المسؤول** لمورد بحث الذكاء الاصطناعي في Azure.

    *يمكنك العثور على هذه القيم في صفحات **النظرة العامة** **والمفاتيح** لمورد بحث الذكاء الاصطناعي في Azure في مدخل Azure.*

3. احفظ ملف الدفعة المحدث.
4. انقر بزر الماوس الأيمن فوق المجلد **create-search** وحدد **فتح في الوحدة الطرفية المتكاملة**.
5. في الجزء الطرفي لمجلد **create-search**، أدخل الأمر التالي وشغل البرنامج النصي الدفعي.

    ```powershell
    ./create-search
    ```

6. عند اكتمال البرنامج النصي، في مدخل Azure، على صفحة مورد بحث الذكاء الاصطناعي في Azure، حدد صفحة **المفهرسات** وانتظر حتى تكتمل عملية الفهرسة.

    *يمكنك تحديد **تحديث** لتتبع تقدم عملية الفهرسة. قد يستغرق الأمر دقيقة أو نحو ذلك حتى يكتمل.*

    > **تلميح**: إذا فشل البرنامج النصي، فتحقق من العناصر النائبة التي أضفتها في ملفي **data_source.json** و**skillset.json** بالإضافة إلى ملف **create-search.cmd**. بعد تصحيح أي أخطاء، قد تحتاج إلى استخدام واجهة مستخدم مدخل Azure لحذف أي مكونات جرى إنشاؤها في مورد البحث قبل إعادة تشغيل البرنامج النصي.

## عرض مخزن المعرفة

بعد تشغيل مفهرس يستخدم مجموعة مهارات لإنشاء مخزن معلومات، يتم الحفاظ على استمرار البيانات التي تم إثراؤها والمستخرجة بواسطة عملية الفهرسة في إسقاطات مخزن المعلومات.

### عرض إسقاطات العنصر

تتكون احتمالات *العنصر* المحددة في مجموعة المهارات الخاصة بـ Margie Travel من ملف JSON لكل وثيقة مفهرسة. يتم تخزين هذه الملفات في حاوية blob في حساب Azure Storage المحدد في تعريف مجموعة المهارات.

1. في مدخل Azure، اعرض حساب تخزين Azure الذي أنشأته مسبقاً.
2. حدد علامة التبويب **مستعرض التخزين** (في الجزء الموجود على اليسار) لعرض حساب التخزين في واجهة مستكشف التخزين في مدخل Azure.
3. عليك توسيع **حاويات كائن ثنائي كبير الحجم** لعرض الحاويات في حساب التخزين. بالإضافة إلى حاوية **margies** حيث يجري تخزين البيانات المصدر، يجب أن يكون هناك حاويتين جديدتين: **margies-images** و **margies-knowledge**. تم إنشاؤها بواسطة عملية الفهرسة.
4. اختر حاوية **margies-knowledge**. يجب أن تحتوي على مجلد لكل مستند مفهرس.
5. افتح أي من المجلدات، ثم افتح ملف **knowledge-projection.json** الذي يحتوي عليه. يحتوي كل ملف JSON على تمثيل للمستند المفهرس، بما في ذلك البيانات التي تم إثراؤها والمستخرجة من مجموعة المهارات كما هو موضح هنا.

```json
{
    "file_id":"abcd1234....",
    "file_name":"Margies Travel Company Info.pdf",
    "url":"https://store....blob.core.windows.net/margies/...pdf",
    "language":"en",
    "sentiment":0.83164644241333008,
    "key_phrases":[
        "Margie’s Travel",
        "Margie's Travel",
        "best travel experts",
        "world-leading travel agency",
        "international reach"
        ],
    "locations":[
        "Dubai",
        "Las Vegas",
        "London",
        "New York",
        "San Francisco"
        ],
    "image_tags":[
        "outdoor",
        "tree",
        "plant",
        "palm"
        ]
}
```

القدرة على إنشاء احتمالات *عنصر* مثل هذا تمكنك من توليد عناصر البيانات التي يجري إثراؤها والتي يمكن دمجها في حل تحليل البيانات الخاص بالمؤسسة -- على سبيل المثال عن طريق استيعاب الملفات JSON في مجرى Azure Data Factory لمزيد من المعالجة أو التحميل في مستودع البيانات.

### عرض إسقاطات الملف

إن احتمالات *الملفات* المعرفة في مجموعة المهارات تنشئ ملفات JPEG لكل صورة جرى استخراجها من المستندات خلال عملية الفهرسة.

1. في واجهة *مستعرض التخزين* في مدخل Azure، حدد حاوية كائن ثنائي كبير الحجم **margies-images**. تحتوي هذه الحاوية على مجلد لكل مستند يحتوي على صور.
2. افتح أي من المجلدات واعرض محتوياته - يحتوي كل مجلد على ملف .jpg \* واحد على الأقل.
3. افتح أيًا من ملفات الصور للتحقق من أنها تحتوي على صور مستخرجة من المستندات.

القدرة على إنشاء احتمالات *ملف* مثل هذا تجعل الفهرسة طريقة فعالة لاستخراج الصور المضمنة من حجم كبير من المستندات.

### عرض إسقاطات الجدول

تشكل احتمالات *الجدول* المحددة في مجموعة المهارات مخططاً ارتباطياً للبيانات المُثراة.

1. في واجهة *مستعرض التخزين* في مدخل Azure، عليك توسيع **الجداول**.
2. حدد جدول **المستندات** لعرض الأعمدة الخاصة به. تتضمن الأعمدة بعض أعمدة جدول تخزين Azure القياسية - لإخفاء هذه الأعمدة، عليك تعديل **خيارات العمود** لتحديد الأعمدة التالية فقط:
    - **document_id** (عمود المفتاح الذي يجري إنشاؤه تلقائياً بواسطة عملية الفهرسة)
    - **file_id** (عنوان URL للملف المرمز)
    - **file_name** (اسم الملف المستخرج من بيانات تعريف المستند)
    - **اللغة** (اللغة التي تجري كتابة المستند بها)
    - **التوجه** درجة التوجه المحسوبة للوثيقة.
    - **URL** عنوان URL لكائن ثنائي كبير الحجم للمستند في تخزين Azure.
3. اعرض الجداول الأخرى التي تم إنشاؤها بواسطة عملية الفهرسة:
    - **ImageTags** (تحتوي على صف لكل علامة صورة فردية مع **document_id** للمستند الذي تظهر فيه العلامة).
    - **KeyPhrases** (تحتوي على صف لكل عبارة مفتاح فردية مع **document_id** للمستند الذي تظهر فيه العبارة).
    - **Locations** (تحتوي على صف لكل موقع على حدة مع **document_id** للمستند الذي يظهر فيه الموقع).

تمكنك القدرة على إنشاء إسقاطات *الجدول* من إنشاء حلول تحليلية وتقارير للاستعلام عن المخطط الارتباطي على سبيل المثال، استخدام Microsoft Power BI. يمكن استخدام أعمدة المفاتيح التي تم توليدها تلقائيًا للانضمام إلى الجداول في الاستعلامات - على سبيل المثال لإرجاع كافة المواقع المذكورة في مستند معين.

## مزيد من المعلومات

لمعرفة المزيد عن إنشاء مخازن المعرفة باستخدام بحث الذكاء الاصطناعي في Azure، راجع [وثائق بحث الذكاء الاصطناعي في Azure](https://docs.microsoft.com/azure/search/knowledge-store-concept-intro).
