---
lab:
  title: إنشاء مخزن المعلومات مع بحث الذكاء الاصطناعي في Azure
  module: Module 12 - Creating a Knowledge Mining Solution
---

# إنشاء مخزن المعلومات مع بحث الذكاء الاصطناعي في Azure

يستخدم بحث الذكاء الاصطناعي في Azure مسارًا إثرائيًا لمهارات الذكاء الاصطناعي لاستخراج الحقول التي جرى إنشاؤها بواسطة الذكاء الاصطناعي من المستندات وإدراجها في فهرس كلمات البحث. وفي حين يمكن اعتبار أن الفهرس هو المخرجات الأولية من عملية الفهرسة، فإن البيانات التي تم إثراؤها به والتي يحتوي عليها قد تكون مفيدة أيضًا بطرق أخرى. على سبيل المثال:

<ul dir='rtl'>
    <li>لأن الفهرس هو أساسًا مجموعة من عناصر JSON، فكل منها يمثل سجلاً مفهرسًا، فقد يكون من المفيد تصدير العناصر كملفات JSON للتكامل في عملية تزامن البيانات باستخدام أدوات مثل Azure Data Factory.</li>
    <li>قد تحتاج إلى تسوية سجلات الفهرس إلى مخطط ارتباطي من الجداول للتحليل وإعداد التقارير باستخدام أدوات مثل Microsoft Power BI.</li>
    <li>بعد استخراج الصور المضمنة من المستندات في أثناء عملية الفهرسة، قد تحتاج إلى حفظ هذه الصور كملفات.</li>
</ul>


في هذه الوحدة، ستنفذ مخزن معلومات لـ <i>Margie's Travel</i>، وهي وكالة سفر وهمية تستخدم المعلومات في الكتيبات وتقييمات الفنادق لمساعدة العملاء في التخطيط للرحلات.

## الاستعداد لتطوير تطبيق في تعليمة Visual Studio البرمجية

ستطور تطبيق البحث لديك باستخدام Visual Studio Code. تم توفير ملفات التعليمات البرمجية لتطبيقك في GitHub repo.

> <b>تلميح</b>: إذا نسخت بالفعل مستودع <b>mslearn-knowledge-mining</b>، فافتحه في Visual Studio code. وإلا فاتبع هذه الخطوات لاستنساخه إلى بيئة تطويرك.

<ol dir='rtl'>
    <li>ابدأ تشغيل Visual Studio Code.</li>
    <li>افتح لوحة (SHIFT+CTRL+P) وشغّل <b>Git: استنسخ الأمر </b> لاستنساخ مستودع <code>https://github.com/MicrosoftLearning/mslearn-knowledge-mining</code> إلى مجلد محلي (لا يُهم أي مجلد).</li>
    <li>عند استنساخ المستودع، افتح المجلد في تعليمة Visual Studio البرمجية.</li>
    <li>انتظر حتى تثبيت ملفات إضافية لدعم مشاريع التعليمات البرمجية C# في المستودع.</li>
    <blockquote><b>ملاحظة</b>: إذا جرت مطالبتك بإضافة الأصول المطلوبة للبناء وتصحيح الأخطاء، فحدد <b>ليس الآن</b>.</blockquote>
</ol>


## إنشاء موارد Azure

> <b>ملاحظة</b>: إذا سبق أن أكملت تمرين <b>[إنشاء حل بحث الذكاء الاصطناعي في Azure](01-azure-search.md)</b>، ولا يزال لديك موارد بحث الذكاء الاصطناعي في Azure في اشتراكك، يمكنك تخطي هذا المقطع وبدء مقطع <b>إنشاء حل بحث</b>. وإلا، اتبع الخطوات أدناه لتوفير موارد Azure المطلوبة.

<ol dir='rtl'>
    <li>في مستعرض ويب، افتح مدخل Microsoft Azure في <code>https://portal.azure.com</code>، ثم سجل الدخول باستخدام حساب Microsoft المقترن باشتراك Azure لديك.</li>
    <li>يمكنك عرض <b>مجموعات الموارد</b> في اشتراكك.</li>
    <li>إذا كنت تستخدم اشتراكًا مقيدًا توفرت فيه مجموعة موارد لك، فحدد مجموعة الموارد لعرض خصائصها. وإلا، فعليك إنشاء مجموعة موارد جديدة باسم من اختيارك، وانتقل إليها عند إنشائها.</li>
    <li>في صفحة <b>النظرة العامة</b> لمجموعة الموارد الخاصة بك، لاحظ <b>معرف الاشتراك</b> و<b>الموقع</b>. ستحتاج إلى هذه القيم، إلى جانب اسم مجموعة الموارد في الخطوات اللاحقة.</li>
    <li>في تعليمة Visual Studio البرمجية، عليك توسيع المجلد <b>Labfiles/03-knowledge-store</b> وحدد <b>setup.cmd</b>. ستستخدم دُفعة البرنامج النصي لتشغيل أوامر واجهة سطر أوامر Azure (CLI) المطلوبة لإنشاء موارد Azure التي تحتاجها.</li>
    <li>انقر بزر الماوس الأيمن فوق المجلد <b>03-knowledge-store</b> وحدد <b>فتح في الوحدة الطرفية المتكاملة</b>.</li>
    <li>ي جزء terminal، أدخِل الأمر التالي لتأسيس اتصال مصادق إلى اشتراك Azure.</li>
    <div style="text-align: left; direction: ltr; margin: 0 20px;">
    <pre><code>az login --output none</code></pre>
    </div>
    <li>عند المطالبة، قم بتسجيل الدخول إلى اشتراكك في Azure. ثم ارجع إلى Visual Studio Code وانتظر حتى تكتمل عملية تسجيل الدخول.</li>
    <li>يمكنك تشغيل الأمر التالي لسرد مواقع Azure.</li>
    <div style="text-align: left; direction: ltr; margin: 0 20px;">
    <pre><code>az account list-locations -o table</code></pre>
    </div>
    <li>في المخرجات، ابحث عن قيمة <b>الاسم</b> التي تتوافق مع موقع مجموعة الموارد الخاصة بك (على سبيل المثال، بالنسبة <i>لشرق الولايات المتحدة</i>، الاسم المقابل هو <i>eastus</i>).</li>
    <li>في البرنامج النصي <b>setup.cmd</b>، عليك تعديل <b>subscription_id</b>، و<b>resource_group</b>، و<b>location</b> المتغيرين باستخدام القيم المناسبة لمعرّف الاشتراك، واسم مجموعة الموارد، واسم الموقع. ثم احفظ التغييرات.</li>
    <li>في الوحدة الطرفية للمجلد <b>03-knowledge-store</b>، أدخل الأمر التالي لتشغيل البرنامج النصي:</li>
    <div style="text-align: left; direction: ltr; margin: 0 20px;">
    <pre><code>./setup</code></pre>
    </div>
    <blockquote><b>ملاحظة</b>: الوحدة النمطية Search CLI قيد المعاينة، وقد تتعطل في <i>- قيد التشغيل ..</i> العملية. إذا حدث ذلك لأكثر من دقيقتين، فاضغط على CTRL+C لإلغاء العملية طويلة الأمد، ثم حدد <b>N</b> عند سؤالك عما إذا كنت تريد إنهاء البرنامج النصي. ومن ثمَّ، يجب أن يكتمل بنجاح.</blockquote>
    <blockquote></blockquote>
    <blockquote>إذا فشل البرنامج النصي، فتأكد من حفظه بأسماء المتغيرات الصحيحة وحاول مرة أخرى.</blockquote>
    <li>
        <p>عند اكتمال البرنامج النصي، راجع المخرجات التي يعرضها ولاحظ المعلومات التالية حول موارد Azure (ستحتاج هذه القيم لاحقًا):</p>
        <ul dir='rtl'>
            <li>Storage account name</li>
            <li>سلسلة اتصال التخزين</li>
            <li>حساب خدمات الذكاء الاصطناعي في Azure</li>
            <li>مفتاح خدمات الذكاء الاصطناعي في Azure</li>
            <li>نقطة نهاية خدمة البحث</li>
            <li>مفتاح مسؤول خدمة البحث</li>
            <li>مفتاح الاستعلام عن خدمة البحث</li>
        </ul>
    </li>
    <li>في مدخل Microsoft Azure، عليك تحديث مجموعة الموارد وتحقق من أنها تحتوي على حساب مخزن Azure ومورد خدمات الذكاء الاصطناعي في Azure ومورد بحث الذكاء الاصطناعي في Azure.</li>
</ol>



## إنشاء حل بحث

الآن بعد أن أصبح لديك موارد Azure الضرورية، يمكنك إنشاء حل بحث يتكون من المكونات التالية:

<ul dir='rtl'>
    <li><b>مصدر بيانات</b> يشير إلى المستندات في حاوية تخزين Azure لديك.</li>
    <li>تحدد <b>مجموعة مهارات</b> مسار إثراء المهارات لاستخراج الحقول التي جرى إنشاؤها الذكاء الاصطناعي من المستندات. تحدد مجموعة المهارات أيضًا <i>التوقعات</i> التي سيجري إنشاؤها في <i>مخزن المعلومات</i> الخاص بك.</li>
    <li><b>فهرس</b> يحدد مجموعة قابلة للبحث من سجلات المستندات.</li>
    <li>يستخرج <b>مفهرس</b> المستندات من مصدر البيانات، ويطبق مجموعة المهارات، ويملأ الفهرس. كما تستمر عملية الفهرسة في التوقعات المحددة في مجموعة المهارات في مخزن المعلومات.</li>
</ul>

في هذا التمرين، ستستخدم واجهة بحث الذكاء الاصطناعي في Azure REST لإنشاء هذه المكونات عن طريق إرسال طلبات JSON.

### إعداد JSON لعمليات REST

ستستخدم واجهة REST لإرسال تعريفات JSON لمكونات بحث الذكاء الاصطناعي في Azure لديك.

<ol dir='rtl'>
    <li>في تعليمة Visual Studio البرمجية في مجلد <b>03-knowledge-store</b>، عليك توسيع مجلد <b>create-search</b> وحدد <b>data_source.json</b>. يحتوي هذا الملف على تعريف JSON لمصدر بيانات يسمى <b>margies-knowledge-data</b>.</li>
    <li>استبدل العنصر النائب <b>YOUR_CONNECTION_STRING</b> بسلسلة الاتصال لحساب تخزين Azure الخاص بك، والذي يجب أن يشبه ما يلي:</li>
    <div style="text-align: left; direction: ltr; margin: 0 20px;">
    <pre><code>DefaultEndpointsProtocol=https;AccountName=ai102str123;AccountKey=12345abcdefg...==;EndpointSuffix=core.windows.net</code></pre>
    </div>
    <p><i>يمكنك العثور على سلسلة الاتصال في صفحة <b>مفاتيح الوصول</b> لحساب التخزين الخاص بك في مدخل Microsoft Azure.</i></p>
    <li>احفظ ملف JSON المُحدَّث وأغلقه.</li>
    <li>في مجلد <b>create-search</b>، افتح <b>skillset.json</b>. يحتوي هذا الملف على تعريف JSON لمصدر بيانات يسمى <b>margies-knowledge-skillset</b>.</li>
    <li>في الجزء العلوي من تعريف مجموعة المهارات، في عنصر <b>cognitiveServices</b>، استبدل العنصر النائب <b>YOUR_COGNITIVE_SERVICES_KEY</b> بأي من المفاتيح الخاصة بموارد خدمات الذكاء الاصطناعي في Azure الخاصة بك.</li>
    <p><i>يمكنك العثور على المفاتيح في صفحة <b>المفاتيح ونقطة النهاية</b> لمورد خدمات الذكاء الاصطناعي في Azure في مدخل Microsoft Azure.</i></p>
    <li>في نهاية مجموعة المهارات الموجودة في مجموعة المهارات الخاصة بك، ابحث عن مهارة <b>Microsoft.Skills.Util.ShaperSkill</b> المسماة <b>Define-projection</b>. تحدد هذه المهارة بنية JSON للبيانات الغنية التي ستُستخدم لتوقعات استمرار التدفق في مخزن المعلومات لكل مستند تجري معالجته بواسطة المفهرس.</li>
    <li>
        <p>في الجزء السفلي من ملف مجموعة المهارات، لاحظ أن مجموعة المهارات تتضمن أيضًا تعريف <b>knowledgeStore</b>، والذي يتضمن سلسلة اتصال لحساب تخزين Azure حيث سيجري إنشاء مخزن المعلومات، ومجموعة من <b>الاحتمالات</b>. هذه المهارات تتضمن ثلاث <i>مجموعات احتمال</i>:</p>
        <ul dir='rtl'>
            <li>مجموعة تحتوي على احتمال <i>عنصر</i> استنادًا إلى مخرج <b>knowledge_projection</b> من مهارة أداة التشكيل في مجموعة المهارات.</li>
            <li>مجموعة تحتوي على احتمال <i>ملف</i> استنادًا إلى مجموعة <b>normalized_images</b> من بيانات الصور المستخرجة من المستندات.</li>
            <li>
                <p>مجموعة تحتوي على احتمالات <i>الجدول</i> التالي:</p>
                <ul dir='rtl'>
                    <li><b>KeyPhrases</b>: تحتوي على عمود مفتاح جرى إنشاؤه تلقائيًا وعمود <b>keyPhrase</b> معيَّن إلى مجموعة مخرجات <b>knowledge_projection/key_phrases/</b> من مهارة أداة التشكيل.</li>
                    <li><b>المواقع</b>: تحتوي على عمود مفتاح جرى إنشاؤه تلقائيًا وعمود <b>الموقع</b> المعيَّن إلى مجموعة مخرجات <b>knowledge_projection/key_phrases/</b> من مهارة أداة التشكيل.</li>
                    <li><b>ImageTags</b>: تحتوي على عمود مفتاح جرى إنشاؤه تلقائيًا وعمود <b>علامة</b> معيَّن إلى مخرج مجموعة <b>knowledge_projection/image_tags/</b> من مهارة أداة التشكيل.</li>
                    <li><b>المستندات</b>: يحتوي على عمود مفتاح جرى إنشاؤه تلقائيًا وجميع قيم مخرجات <b>knowledge_projection</b> من مهارة أداة التشكيل التي لم يجري تعيينها بالفعل إلى جدول.</li>
                </ul>
            </li>
        </ul>
    </li>
    <li>استبدل العنصر النائب <b>YOUR_CONNECTION_STRING</b> لقيمة <b>storageConnectionString</b> بسلسلة الاتصال لحساب التخزين الخاص بك.</li>
    <li>احفظ ملف JSON المُحدَّث وأغلقه.</li>
    <li>في مجلد <b>create-search</b>، افتح <b>index.json</b>. يحتوي هذا الملف على تعريف JSON لفهرس يسمى <b>margies-knowledge-index</b>.</li>
    <li>راجع JSON للفهرس، ثم أغلق الملف دون إجراء أي تغييرات.</li>
    <li>في مجلد <b>create-search</b>، افتح <b>indexer.json</b>. يحتوي هذا الملف على تعريف JSON لمفهرس يسمى <b>margies-knowledge-indexer</b>.</li>
    <li>راجع JSON للفهرس، ثم أغلق الملف دون إجراء أي تغييرات.</li>
</ol>


### إرسال طلبات REST

الآن بعد أن أعددت كائنات JSON التي تحدد مكونات حل البحث، يمكنك إرسال مستندات JSON إلى واجهة REST لإنشائها.

<ol dir='rtl'>
    <li>في مجلد <b>create-search</b>، افتح <b>create-search.cmd</b>. يستخدم هذا البرنامج النصي الدفعي الأداة المساعدة cURL لإرسال تعريفات JSON إلى واجهة REST لمورد بحث الذكاء الاصطناعي في Azure.</li>
    <li>استبدل العناصر النائبة والمتغيرة <b>YOUR_SEARCH_URL</b> <b>وYOUR_ADMIN_KEY</b> بعنوان <b>Url</b> وأحد <b>مفاتيح المسؤول</b> لمورد بحث الذكاء الاصطناعي في Azure.</li>
    <p><i>يمكنك العثور على هذه القيم في صفحات <b>النظرة العامة</b> <b>والمفاتيح</b> لمورد بحث الذكاء الاصطناعي في Azure في مدخل Microsoft Azure.</i></p>
    <li>احفظ ملف الدفعة المُحدَّث.</li>
    <li>انقر بزر الماوس الأيمن فوق المجلد <b>create-search</b> وحدد <b>فتح في الوحدة الطرفية المتكاملة</b>.</li>
    <li>في الجزء الطرفي لمجلد <b>create-search</b>، أدخل الأمر التالي وشغَّل دُفعة البرنامج النصي.</li>
    <div style="text-align: left; direction: ltr; margin: 0 20px;">
    <pre><code>./create-search</code></pre>
    </div>
    <li>
        <p>عند اكتمال البرنامج النصي، في مدخل Azure، على صفحة مورد بحث الذكاء الاصطناعي في Azure، حدد صفحة <b>المفهرسات</b> وانتظر حتى تكتمل عملية الفهرسة.</p>
        <p><i>يمكنك تحديد <b>تحديث</b> لتتبُّع تقدُّم عملية الفهرسة. قد يستغرق الأمر دقيقة أو نحو ذلك حتى يكتمل.</i></p>
        <blockquote><b>تلميح</b>: إذا فشل البرنامج النصي، فتحقق من العناصر النائبة التي أضفتها في ملفي <b>data_source.json</b> و<b>skillset.json</b> بالإضافة إلى ملف <b>create-search.cmd</b>. بعد تصحيح أي أخطاء، قد تحتاج إلى استخدام واجهة مستخدم مدخل Azure لحذف أي مكونات جرى إنشاؤها في مورد البحث قبل إعادة تشغيل البرنامج النصي.</blockquote>
    </li>
</ol>


## عرض مخزن المعلومات

بعد تشغيل مفهرس يستخدم مجموعة مهارات لإنشاء مخزن معلومات، يتم الحفاظ على استمرار البيانات التي تم إثراؤها والمستخرجة بواسطة عملية الفهرسة في إسقاطات مخزن المعلومات.

### عرض إسقاطات العنصر

تتكون احتمالات <i>العنصر</i> المحددة في مجموعة المهارات الخاصة بـ Margie Travel من ملف JSON لكل وثيقة مفهرسة. يتم تخزين هذه الملفات في حاوية blob في حساب Azure Storage المحدد في تعريف مجموعة المهارات.

<ol dir='rtl'>
    <li>في مدخل Microsoft Azure، اعرض حساب تخزين Azure الذي أنشأته مسبقًا.</li>
    <li>حدد علامة التبويب <b>مستعرض التخزين</b> (في الجزء الموجود على اليسار) لعرض حساب التخزين في واجهة مستكشف التخزين في مدخل Microsoft Azure.</li>
    <li>عليك توسيع <b>حاويات كائن ثنائي كبير الحجم</b> لعرض الحاويات في حساب التخزين. بالإضافة إلى حاوية <b>margies</b> حيث يجري تخزين البيانات المصدر، يجب أن يكون هناك حاويتين جديدتين: <b>margies-images</b> و <b>margies-knowledge</b>. تم إنشاؤها بواسطة عملية الفهرسة.</li>
    <li>اختر حاوية <b>margies-knowledge</b>. يجب أن تحتوي على مجلد لكل مستند مفهرس.</li>
    <li>افتح أي من المجلدات، ثم افتح ملف <b>knowledge-projection.json</b> الذي يحتوي عليه. يحتوي كل ملف JSON على تمثيل للمستند المفهرس، بما في ذلك البيانات التي تم إثراؤها والمستخرجة من مجموعة المهارات كما هو موضح هنا.</li>
    <div style="text-align: left; direction: ltr; margin: 0 20px;">
    <pre><code>{
"file_id":"abcd1234....",
"file_name":"Margies Travel Company Info.pdf",
"url":"https://store....blob.core.windows.net/margies/...pdf",
"language":"en",
"sentiment":0.83164644241333008,
"key_phrases":[
    "Margie’s Travel",
    "Margie's Travel",
    "best travel experts",
    "world-leading travel agency",
    "international reach"
],
"locations":[
    "Dubai",
    "Las Vegas",
    "London",
    "New York",
    "San Francisco"
],
"image_tags":[
    "outdoor",
    "tree",
    "plant",
    "palm"
    ]
}</code></pre>
    </div>
</ol>

القدرة على إنشاء احتمالات <i>عنصر</i> مثل هذا تمكنك من توليد عناصر البيانات التي يجري إثراؤها والتي يمكن دمجها في حل تحليل البيانات الخاص بالمؤسسة -- على سبيل المثال عن طريق استيعاب الملفات JSON في مجرى Azure Data Factory لمزيد من المعالجة أو التحميل في مستودع البيانات.

### عرض إسقاطات الملف

إن احتمالات <i>الملفات</i> المعرفة في مجموعة المهارات تنشئ ملفات JPEG لكل صورة جرى استخراجها من المستندات خلال عملية الفهرسة.

<ol dir='rtl'>
    <li>في واجهة <i>مستعرض التخزين</i> في مدخل Microsoft Azure، حدد حاوية كائن ثنائي كبير الحجم <b>margies-images</b>. تحتوي هذه الحاوية على مجلد لكل مستند يحتوي على صور.</li>
    <li>افتح أي من المجلدات واعرض محتوياته - يحتوي كل مجلد على ملف .jpg * واحد على الأقل.</li>
    <li>افتح أيًا من ملفات الصور للتحقق من أنها تحتوي على صور مستخرجة من المستندات.</li>
</ol>

القدرة على إنشاء احتمالات <i>ملف</i> مثل هذا تجعل الفهرسة طريقة فعالة لاستخراج الصور المضمنة من حجم كبير من المستندات.

### عرض إسقاطات الجدول

تشكل احتمالات <i>الجدول</i> المحددة في مجموعة المهارات مخططًا ارتباطيًا للبيانات الثرية.

<ol dir='rtl'>
    <li>في واجهة <i>مستعرض التخزين</i> في مدخل Microsoft Azure، عليك توسيع <b>الجداول</b>.</li>
    <li>
        <p>حدد جدول <b>المستندات</b> لعرض الأعمدة الخاصة به. تتضمن الأعمدة بعض أعمدة جدول تخزين Azure القياسية - لإخفاء هذه الأعمدة، عليك تعديل <b>خيارات العمود</b> لتحديد الأعمدة التالية فقط:</p>
        <ul dir='rtl'>
            <li><b>document_id</b> (عمود المفتاح الذي يجري إنشاؤه تلقائيًا بواسطة عملية الفهرسة)</li>
            <li><b>file_id</b> (عنوان URL للملف المشفر)</li>
            <li><b>file_name</b> (اسم الملف المستخرج من بيانات تعريف المستند)</li>
            <li><b>اللغة</b> (اللغة التي تجري كتابة المستند بها)</li>
            <li><b>التوجه</b> درجة التوجه المحسوبة للمستند.</li>
            <li><b>URL</b> عنوان URL لكائن ثنائي كبير الحجم للمستند في تخزين Azure.</li>
        </ul>
    </li>
    <li>
        <p>اعرض الجداول الأخرى التي تم إنشاؤها بواسطة عملية الفهرسة:</p>
        <ul dir='rtl'>
            <li><b>ImageTags</b> (تحتوي على صف لكل علامة صورة فردية مع <b>document_id</b> للمستند الذي تظهر فيه العلامة).</li>
            <li><b>KeyPhrases</b> (تحتوي على صف لكل عبارة مفتاح فردية مع <b>document_id</b> للمستند الذي تظهر فيه العبارة).</li>
            <li><b>Locations</b> (تحتوي على صف لكل موقع على حدة مع <b>document_id</b> للمستند الذي يظهر فيه الموقع).</li>
        </ul>
    </li>
</ol>

تمكنك القدرة على إنشاء إسقاطات <i>الجدول<i> من إنشاء حلول تحليلية وتقارير للاستعلام عن المخطط الارتباطي على سبيل المثال، استخدام Microsoft Power BI. يمكن استخدام أعمدة المفاتيح التي تم توليدها تلقائيًا للانضمام إلى الجداول في الاستعلامات - على سبيل المثال لإرجاع كافة المواقع المذكورة في مستند معين.

## التنظيف

الآن بعد أن أكملت التمرين، احذف جميع الموارد التي لم تعد بحاجة إليها. احذف موارد Azure:

<ol dir='rtl'>
    <li>في <b>مدخل Azure</b>، حدد "Resource groups".</li>
    <li>حدد مجموعة الموارد التي لا تحتاج إليها، ثم حدد <b>حذف مجموعات الموارد</b>.</li>
</ol>

## مزيد من المعلومات

لمعرفة المزيد عن إنشاء مخازن المعرفة باستخدام بحث الذكاء الاصطناعي في Azure، راجع <a href="https://docs.microsoft.com/azure/search/knowledge-store-concept-intro">وثائق بحث الذكاء الاصطناعي في Azure</a>.
